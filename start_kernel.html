<h2 id="start_kernel">start_kernel</h2>

<h3 id="boot_init_stack_canary">boot_init_stack_canary</h3>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"></th>
	<th style="text-align:center;"># TO tag</th>
	<th style="text-align:left;">FROM</th>
	<th style="text-align:left;">line</th>
	<th style="text-align:left;">in file/text</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">1</td>
	<td style="text-align:center;">2</td>
	<td style="text-align:left;">boot_init_stack_canary</td>
	<td style="text-align:left;">485</td>
	<td style="text-align:left;">init/main.c</td>
</tr>
<tr>
	<td style="text-align:left;">2</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">get_random_bytes</td>
	<td style="text-align:left;">73</td>
	<td style="text-align:left;">arch/x86/include/asm/stackprotector.h</td>
</tr>
<tr>
	<td style="text-align:left;">3</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">extract_entropy</td>
	<td style="text-align:left;">1063</td>
	<td style="text-align:left;">drivers/char/random.c</td>
</tr>
<tr>
	<td style="text-align:left;">4</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">xfer_secondary_pool</td>
	<td style="text-align:left;">990</td>
	<td style="text-align:left;">drivers/char/random.c</td>
</tr>
<tr>
	<td style="text-align:left;">5</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">credit_entropy_bits</td>
	<td style="text-align:left;">860</td>
	<td style="text-align:left;">drivers/char/random.c</td>
</tr>
<tr>
	<td style="text-align:left;">6</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">kill_fasync</td>
	<td style="text-align:left;">607</td>
	<td style="text-align:left;">drivers/char/random.c</td>
</tr>
<tr>
	<td style="text-align:left;">7</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">kill_fasync_rcu</td>
	<td style="text-align:left;">825</td>
	<td style="text-align:left;">fs/fcntl.c</td>
</tr>
<tr>
	<td style="text-align:left;">8</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">send_sigio</td>
	<td style="text-align:left;">811</td>
	<td style="text-align:left;">fs/fcntl.c</td>
</tr>
<tr>
	<td style="text-align:left;">9</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">send_sigio_to_task</td>
	<td style="text-align:left;">606</td>
	<td style="text-align:left;">fs/fcntl.c</td>
</tr>
<tr>
	<td style="text-align:left;">10</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">sigio_perm</td>
	<td style="text-align:left;">553</td>
	<td style="text-align:left;">fs/fcntl.c</td>
</tr>
<tr>
	<td style="text-align:left;">11</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">rcu_read_lock</td>
	<td style="text-align:left;">533</td>
	<td style="text-align:left;">fs/fcntl.c</td>
</tr>
<tr>
	<td style="text-align:left;">12</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">rcu_read_acquire</td>
	<td style="text-align:left;">640</td>
	<td style="text-align:left;">include/linux/rcupdate.h</td>
</tr>
<tr>
	<td style="text-align:left;">13</td>
	<td style="text-align:center;">2</td>
	<td style="text-align:left;">lock_acquire</td>
	<td style="text-align:left;">238</td>
	<td style="text-align:left;">include/linux/rcupdate.h</td>
</tr>
<tr>
	<td style="text-align:left;">14</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">__lock_acquire</td>
	<td style="text-align:left;">3554</td>
	<td style="text-align:left;">kernel/lockdep.c</td>
</tr>
<tr>
	<td style="text-align:left;">15</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">register_lock_class</td>
	<td style="text-align:left;">3041</td>
	<td style="text-align:left;">kernel/lockdep.c</td>
</tr>
<tr>
	<td style="text-align:left;">16</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">look_up_lock_class</td>
	<td style="text-align:left;">724</td>
	<td style="text-align:left;">kernel/lockdep.c</td>
</tr>
<tr>
	<td style="text-align:left;">17</td>
	<td style="text-align:center;">26</td>
	<td style="text-align:left;">dump_stack</td>
	<td style="text-align:left;">669</td>
	<td style="text-align:left;">kernel/lockdep.c</td>
</tr>
<tr>
	<td style="text-align:left;">18</td>
	<td style="text-align:center;">3</td>
	<td style="text-align:left;">stack_frame</td>
	<td style="text-align:left;">188</td>
	<td style="text-align:left;">arch/x86/kernel/dumpstack.c</td>
</tr>
<tr>
	<td style="text-align:left;">19</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">get_bp</td>
	<td style="text-align:left;">69</td>
	<td style="text-align:left;">get_bp(bp);</td>
</tr>
</tbody>
</table>

<pre><code>50 #ifdef CONFIG_X86_32
51 #define STACKSLOTS_PER_LINE 8
52 #define get_bp(bp) asm(&quot;movl %%ebp, %0&quot; : &quot;=r&quot; (bp) :)
53 #else
54 #define STACKSLOTS_PER_LINE 4
55 #define get_bp(bp) asm(&quot;movq %%rbp, %0&quot; : &quot;=r&quot; (bp) :)
56 #endif
</code></pre>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"></th>
	<th style="text-align:center;"># TO tag</th>
	<th style="text-align:left;">FROM</th>
	<th style="text-align:left;">line</th>
	<th style="text-align:left;">in file/text</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">1</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">send_sigio_to_task</td>
	<td style="text-align:left;">606</td>
	<td style="text-align:left;">fs/fcntl.c</td>
</tr>
<tr>
	<td style="text-align:left;">2</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">sigio_perm</td>
	<td style="text-align:left;">553</td>
	<td style="text-align:left;">fs/fcntl.c</td>
</tr>
<tr>
	<td style="text-align:left;">3</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">rcu_read_lock</td>
	<td style="text-align:left;">533</td>
	<td style="text-align:left;">fs/fcntl.c</td>
</tr>
<tr>
	<td style="text-align:left;">4</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">rcu_read_acquire</td>
	<td style="text-align:left;">640</td>
	<td style="text-align:left;">include/linux/rcupdate.h</td>
</tr>
<tr>
	<td style="text-align:left;">5</td>
	<td style="text-align:center;">2</td>
	<td style="text-align:left;">lock_acquire</td>
	<td style="text-align:left;">238</td>
	<td style="text-align:left;">include/linux/rcupdate.h</td>
</tr>
<tr>
	<td style="text-align:left;">6</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">__lock_acquire</td>
	<td style="text-align:left;">3554</td>
	<td style="text-align:left;">kernel/lockdep.c</td>
</tr>
<tr>
	<td style="text-align:left;">7</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">register_lock_class</td>
	<td style="text-align:left;">3041</td>
	<td style="text-align:left;">kernel/lockdep.c</td>
</tr>
<tr>
	<td style="text-align:left;">8</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">look_up_lock_class</td>
	<td style="text-align:left;">724</td>
	<td style="text-align:left;">kernel/lockdep.c</td>
</tr>
<tr>
	<td style="text-align:left;">9</td>
	<td style="text-align:center;">26</td>
	<td style="text-align:left;">dump_stack</td>
	<td style="text-align:left;">669</td>
	<td style="text-align:left;">kernel/lockdep.c</td>
</tr>
<tr>
	<td style="text-align:left;">10</td>
	<td style="text-align:center;">10</td>
	<td style="text-align:left;">show_trace</td>
	<td style="text-align:left;">195</td>
	<td style="text-align:left;">arch/x86/kernel/dumpstack.c</td>
</tr>
<tr>
	<td style="text-align:left;">11</td>
	<td style="text-align:center;">3</td>
	<td style="text-align:left;">show_trace_log_lvl</td>
	<td style="text-align:left;">172</td>
	<td style="text-align:left;">arch/x86/kernel/dumpstack.c</td>
</tr>
<tr>
	<td style="text-align:left;">12</td>
	<td style="text-align:center;">2</td>
	<td style="text-align:left;">dump_trace</td>
	<td style="text-align:left;">166</td>
	<td style="text-align:left;">arch/x86/kernel/dumpstack.c</td>
</tr>
<tr>
	<td style="text-align:left;">13</td>
	<td style="text-align:center;">4</td>
	<td style="text-align:left;">touch_nmi_watchdog</td>
	<td style="text-align:left;">52</td>
	<td style="text-align:left;">arch/x86/kernel/dumpstack_32.c</td>
</tr>
<tr>
	<td style="text-align:left;">14</td>
	<td style="text-align:center;">2</td>
	<td style="text-align:left;">touch_softlockup_watchdog</td>
	<td style="text-align:left;">165</td>
	<td style="text-align:left;">touch_softlockup_watchdog();</td>
</tr>
</tbody>
</table>

<p>The <code>watchdog</code> functions are unsured whether containing priviledge instructions.</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:center;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"></th>
	<th style="text-align:center;"># TO tag</th>
	<th style="text-align:left;">FROM</th>
	<th style="text-align:left;">line</th>
	<th style="text-align:left;">in file/text</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">1</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">send_sigio_to_task</td>
	<td style="text-align:left;">606</td>
	<td style="text-align:left;">fs/fcntl.c</td>
</tr>
<tr>
	<td style="text-align:left;">2</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">sigio_perm</td>
	<td style="text-align:left;">553</td>
	<td style="text-align:left;">fs/fcntl.c</td>
</tr>
<tr>
	<td style="text-align:left;">3</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">rcu_read_lock</td>
	<td style="text-align:left;">533</td>
	<td style="text-align:left;">fs/fcntl.c</td>
</tr>
<tr>
	<td style="text-align:left;">4</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">rcu_read_acquire</td>
	<td style="text-align:left;">640</td>
	<td style="text-align:left;">include/linux/rcupdate.h</td>
</tr>
<tr>
	<td style="text-align:left;">5</td>
	<td style="text-align:center;">2</td>
	<td style="text-align:left;">lock_acquire</td>
	<td style="text-align:left;">238</td>
	<td style="text-align:left;">include/linux/rcupdate.h</td>
</tr>
<tr>
	<td style="text-align:left;">6</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">__lock_acquire</td>
	<td style="text-align:left;">3554</td>
	<td style="text-align:left;">kernel/lockdep.c</td>
</tr>
<tr>
	<td style="text-align:left;">7</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">lockstat_clock</td>
	<td style="text-align:left;">3098</td>
	<td style="text-align:left;">kernel/lockdep.c</td>
</tr>
<tr>
	<td style="text-align:left;">8</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">local_clock</td>
	<td style="text-align:left;">158</td>
	<td style="text-align:left;">kernel/lockdep.c</td>
</tr>
<tr>
	<td style="text-align:left;">9</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">sched_clock_cpu</td>
	<td style="text-align:left;">342</td>
	<td style="text-align:left;">kernel/sched_clock.c</td>
</tr>
<tr>
	<td style="text-align:left;">10</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">sched_clock_remote</td>
	<td style="text-align:left;">256</td>
	<td style="text-align:left;">kernel/sched_clock.c</td>
</tr>
<tr>
	<td style="text-align:left;">11</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">sched_clock_local</td>
	<td style="text-align:left;">192</td>
	<td style="text-align:left;">kernel/sched_clock.c</td>
</tr>
<tr>
	<td style="text-align:left;">12</td>
	<td style="text-align:center;">37</td>
	<td style="text-align:left;">sched_clock</td>
	<td style="text-align:left;">147</td>
	<td style="text-align:left;">kernel/sched_clock.c</td>
</tr>
<tr>
	<td style="text-align:left;">13</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">native_sched_clock</td>
	<td style="text-align:left;">75</td>
	<td style="text-align:left;">arch/x86/kernel/tsc.c</td>
</tr>
<tr>
	<td style="text-align:left;">14</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">rdtscll</td>
	<td style="text-align:left;">60</td>
	<td style="text-align:left;">arch/x86/kernel/tsc.c</td>
</tr>
<tr>
	<td style="text-align:left;">15</td>
	<td style="text-align:center;">1</td>
	<td style="text-align:left;">__native_read_tsc</td>
	<td style="text-align:left;">238</td>
	<td style="text-align:left;">((val) = __native_read_tsc())</td>
</tr>
</tbody>
</table>

<pre><code>121 static __always_inline unsigned long long __native_read_tsc(void)
122 {
123         DECLARE_ARGS(val, low, high);
124 
125         asm volatile(&quot;rdtsc&quot; : EAX_EDX_RET(val, low, high));
126 
127         return EAX_EDX_VAL(val, low, high);
128 }
</code></pre>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"></th>
	<th style="text-align:left;"># TO tag</th>
	<th style="text-align:left;">FROM</th>
	<th style="text-align:left;">line</th>
	<th style="text-align:left;">in file/text</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">1</td>
	<td style="text-align:left;">2</td>
	<td style="text-align:left;">boot_init_stack_canary</td>
	<td style="text-align:left;">485</td>
	<td style="text-align:left;">init/main.c</td>
</tr>
<tr>
	<td style="text-align:left;">2</td>
	<td style="text-align:left;">1</td>
	<td style="text-align:left;">__native_read_tsc</td>
	<td style="text-align:left;">74</td>
	<td style="text-align:left;">arch/x86/include/asm/stackprotector.h</td>
</tr>
</tbody>
</table>

<p><code>__native_read_tsc</code> is called again.</p>

<h3 id="boot_cpu_init">boot_cpu_init</h3>

<p># TO tag FROM line in file/text<br/>
1 1 boot_cpu_init 497 init/main.c<br/>
2 1 set_cpu_online 437 init/main.c<br/>
3 1 cpumask_set_cpu 635 kernel/cpu.c<br/>
4 24 set_bit 256 include/linux/cpumask.h </p>

<pre><code>38 static inline void set_bit(int nr, void *addr)
39 {
40         asm(&quot;btsl %1,%0&quot; : &quot;+m&quot; (*(u32 *)addr) : &quot;Ir&quot; (nr));
41 }
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 1 boot_cpu_init 497 init/main.c<br/>
2 1 set_cpu_online 437 init/main.c<br/>
3 1 cpumask_clear_cpu 637 kernel/cpu.c<br/>
4 24 clear_bit 266 include/linux/cpumask.h </p>

<pre><code>97 static __always_inline void
98 clear_bit(int nr, volatile unsigned long *addr)
99 {
100         if (IS_IMMEDIATE(nr)) {
101                 asm volatile(LOCK_PREFIX &quot;andb %1,%0&quot;
102                         : CONST_MASK_ADDR(nr, addr)
103                         : &quot;iq&quot; ((u8)~CONST_MASK(nr)));
104         } else {
105                 asm volatile(LOCK_PREFIX &quot;btr %1,%0&quot;
106                         : BITOP_ADDR(addr)
107                         : &quot;Ir&quot; (nr));
108         }
109 }
</code></pre>

<h3 id="setup_arch">setup_arch</h3>

<p># TO tag FROM line in file/text<br/>
1 29 setup_arch 500 init/main.c<br/>
2 2 visws_early_detect 774 arch/x86/kernel/setup.c<br/>
3 20 inb_p 222 arch/x86/platform/visws/visws_quirks.c<br/>
4 28 inb 136 include/asm-generic/io.h </p>

<pre><code> 48 static inline u8 inb(u16 port)
 49 {
 50         u8 v;
 51         asm volatile(&quot;inb %1,%0&quot; : &quot;=a&quot; (v) : &quot;dN&quot; (port));
 52         return v;
 53 }
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 29 setup_arch 500 init/main.c<br/>
2 2 visws_early_detect 774 arch/x86/kernel/setup.c<br/>
3 20 outb_p 264 arch/x86/platform/visws/visws_quirks.c<br/>
4 30 outb 139 include/asm-generic/io.h </p>

<pre><code>44 static inline void outb(u8 v, u16 port)
45 {
46         asm volatile(&quot;outb %0,%1&quot; : : &quot;a&quot; (v), &quot;dN&quot; (port));
47 }
</code></pre>

<p><code>visws_early_detect</code> function calls <code>inb_p</code> and <code>outb_p</code> multiple times in function body.</p>

<p># TO tag FROM line in file/text<br/>
1 29 setup_arch 500 init/main.c<br/>
2 1 load_cr3 784 arch/x86/kernel/setup.c<br/>
3 3 write_cr3 187 arch/x86/include/asm/processor.h<br/>
4 1 native_write_cr3 330 native_write_cr3(x); </p>

<pre><code>247 static inline void native_write_cr3(unsigned long val)
248 {
249         asm volatile(&quot;mov %0,%%cr3&quot;: : &quot;r&quot; (val), &quot;m&quot; (__force_order));
250 }
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 29 setup_arch 500 init/main.c<br/>
2 4 __flush_tlb_all 785 arch/x86/kernel/setup.c<br/>
3 6 __flush_tlb_global 52 arch/x86/include/asm/tlbflush.h<br/>
4 1 __native_flush_tlb_global 14 arch/x86/include/asm/tlbflush.h<br/>
5 1 native_write_cr4 37 arch/x86/include/asm/tlbflush.h </p>

<pre><code>275 static inline void native_write_cr4(unsigned long val)
276 {       
277         asm volatile(&quot;mov %0,%%cr4&quot;: : &quot;r&quot; (val), &quot;m&quot; (__force_order));
278 }
</code></pre>

<p>Function <code>early_trap_init</code>, <code>early_cpu_init</code> and <code>early_ioremap_init</code> have not found tags.</p>

<p># TO tag FROM line in file/text<br/>
1 29 setup_arch 500 init/main.c<br/>
2 2 mtrr_bp_init 951 arch/x86/kernel/setup.c<br/>
3 1 get_mtrr_state 667 arch/x86/kernel/cpu/mtrr/main.c<br/>
4 1 get_fixed_ranges 405 arch/x86/kernel/cpu/mtrr/generic.c<br/>
5 1 k8_check_syscfg_dram_mod_en 280 arch/x86/kernel/cpu/mtrr/generic.c<br/>
6 1 rdmsr 57 arch/x86/kernel/cpu/mtrr/generic.c<br/>
7 1 native_read_msr 150 u64 __val = native_read_msr((msr));</p>

<pre><code>68 static inline unsigned long long native_read_msr(unsigned int msr)
69 {
70         DECLARE_ARGS(val, low, high);
71 
72         asm volatile(&quot;rdmsr&quot; : EAX_EDX_RET(val, low, high) : &quot;c&quot; (msr));
73         return EAX_EDX_VAL(val, low, high);
74 }
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 29 setup_arch 500 init/main.c<br/>
2 2 mtrr_bp_init 951 arch/x86/kernel/setup.c<br/>
3 1 get_mtrr_state 667 arch/x86/kernel/cpu/mtrr/main.c<br/>
4 1 get_fixed_ranges 405 arch/x86/kernel/cpu/mtrr/generic.c<br/>
5 1 k8_check_syscfg_dram_mod_en 280 arch/x86/kernel/cpu/mtrr/generic.c<br/>
6 1 mtrr_wrmsr 63 arch/x86/kernel/cpu/mtrr/generic.c<br/>
7 1 wrmsr_safe 461 arch/x86/kernel/cpu/mtrr/generic.c<br/>
8 1 native_write_msr_safe 169 return native_write_msr_safe(msr, low, high); </p>

<pre><code> 99 notrace static inline int native_write_msr_safe(unsigned int msr,
 100                                         unsigned low, unsigned high)
 101 {    
 102         int err;
 103         asm volatile(&quot;2: wrmsr ; xor %[err],%[err]\n&quot;
 104                      &quot;1:\n\t&quot;     
 105                      &quot;.section .fixup,\&quot;ax\&quot;\n\t&quot; 
 106                      &quot;3:  mov %[fault],%[err] ; jmp 1b\n\t&quot;
 107                      &quot;.previous\n\t&quot;   
 108                      _ASM_EXTABLE(2b, 3b)
 109                      : [err] &quot;=a&quot; (err)    
 110                      : &quot;c&quot; (msr), &quot;0&quot; (low), &quot;d&quot; (high),
 111                        [fault] &quot;i&quot; (-EIO)
 112                      : &quot;memory&quot;);
 113         return err;       
 114 }                           
</code></pre>

<p># TO tag FROM line in file/text<br/>
 1 29 setup_arch 500 init/main.c<br/>
 2 2 mtrr_bp_init 951 arch/x86/kernel/setup.c<br/>
 3 1 get_mtrr_state 667 arch/x86/kernel/cpu/mtrr/main.c<br/>
 4 2 prepare_set 428 arch/x86/kernel/cpu/mtrr/generic.c<br/>
 5 6 wbinvd 681 arch/x86/kernel/cpu/mtrr/generic.c<br/>
 6 1 emulator_wbinvd 4704 .wbinvd = emulator_wbinvd,<br/>
 7 1 kvm_emulate_wbinvd 4446 kvm_emulate_wbinvd(emul_to_vcpu(ctxt)); </p>

<p><code>
 4425 int kvm_emulate_wbinvd(struct kvm_vcpu *vcpu)
</code></p>

<p>THis function is in <code>arch/x86/kvm/x86.c</code>. kvm will do emulation on <code>wbinvd</code> when booting system. </p>

<p># TO tag FROM line in file/text<br/>
 1 29 setup_arch 500 init/main.c<br/>
 2 2 mtrr_bp_init 951 arch/x86/kernel/setup.c<br/>
 3 1 get_mtrr_state 667 arch/x86/kernel/cpu/mtrr/main.c<br/>
 4 2 prepare_set 428 arch/x86/kernel/cpu/mtrr/generic.c<br/>
 5 5 __flush_tlb 690 arch/x86/kernel/cpu/mtrr/generic.c<br/>
 6 1 __native_flush_tlb 13 arch/x86/include/asm/tlbflush.h<br/>
 7 1 native_write_cr3 20 arch/x86/include/asm/tlbflush.h </p>

<pre><code>247 static inline void native_write_cr3(unsigned long val)
248 {       
249         asm volatile(&quot;mov %0,%%cr3&quot;: : &quot;r&quot; (val), &quot;m&quot; (__force_order));
250 }       
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 29 setup_arch 500 init/main.c<br/>
2 2 mtrr_bp_init 951 arch/x86/kernel/setup.c<br/>
3 1 get_mtrr_state 667 arch/x86/kernel/cpu/mtrr/main.c<br/>
4 2 post_set 432 post_set(); </p>

<pre><code>700 static void post_set(void) __releases(set_atomicity_lock)
701 {       
702         /* Flush TLBs (no need to flush caches - they are disabled) */
703         __flush_tlb();
704 
705         /* Intel (P6) standard MTRRs */
706         mtrr_wrmsr(MSR_MTRRdefType, deftype_lo, deftype_hi);
707         
708         /* Enable caches */
709         write_cr0(read_cr0() &amp; 0xbfffffff);
710                 
711         /* Restore value of CR4 */
712         if (cpu_has_pge)
713                 write_cr4(cr4);
714         raw_spin_unlock(&amp;set_atomicity_lock);
715 }       
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 29 setup_arch 500 init/main.c<br/>
2 1 init_memory_mapping 1016 arch/x86/kernel/setup.c<br/>
3 1 set_in_cr4 161 arch/x86/mm/init.c<br/>
4 3 write_cr4 608 arch/x86/include/asm/processor.h<br/>
5 1 native_write_cr4 345 native_write_cr4(x); </p>

<pre><code>275 static inline void native_write_cr4(unsigned long val)
276 {
277         asm volatile(&quot;mov %0,%%cr4&quot;: : &quot;r&quot; (val), &quot;m&quot; (__force_order));
278 }
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 29 setup_arch 500 init/main.c<br/>
2 1 init_memory_mapping 1016 arch/x86/kernel/setup.c<br/>
3 4 kernel_physical_mapping_init 280 arch/x86/mm/init.c<br/>
4 1 phys_pud_init 590 arch/x86/mm/init_64.c<br/>
5 13 pud_populate 549 arch/x86/mm/init_64.c<br/>
6 42 flush_tlb_mm 171 arch/x86/mm/pgtable.c<br/>
7 2 leave_mm 295 arch/x86/mm/tlb.c<br/>
8 1 load_cr3 68 arch/x86/mm/tlb.c<br/>
9 3 write_cr3 187 arch/x86/include/asm/processor.h<br/>
10 1 native_write_cr3 330 native_write_cr3(x); </p>

<pre><code>247 static inline void native_write_cr3(unsigned long val)
248 {
249         asm volatile(&quot;mov %0,%%cr3&quot;: : &quot;r&quot; (val), &quot;m&quot; (__force_order));
250 }
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 29 setup_arch 500 init/main.c<br/>
2 1 init_ohci1394_dma_on_all_controllers 1048 arch/x86/kernel/setup.c<br/>
3 2 read_pci_config 282 drivers/firewire/init_ohci1394_dma.c<br/>
4 27 outl 13 arch/x86/pci/early.c </p>

<pre><code>66 static inline void outl(u32 v, u16 port)
67 {
68         asm volatile(&quot;outl %0,%1&quot; : : &quot;a&quot; (v), &quot;dN&quot; (port));
69 }
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 29 setup_arch 500 init/main.c<br/>
2 2 vsmp_init 1057 arch/x86/kernel/setup.c<br/>
3 1 detect_vsmp_box 154 arch/x86/kernel/vsmp_64.c<br/>
4 2 read_pci_config 128 arch/x86/kernel/vsmp_64.c<br/>
5 27 outl 13 arch/x86/pci/early.c </p>

<pre><code>10 u32 read_pci_config(u8 bus, u8 slot, u8 func, u8 offset)
11 {
12         u32 v;
13         outl(0x80000000 | (bus&lt;&lt;16) | (slot&lt;&lt;11) | (func&lt;&lt;8) | offset, 0xcf8);
14         v = inl(0xcfc);
15         return v;
16 }
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 29 setup_arch 500 init/main.c<br/>
2 1 kvmclock_init 1072 arch/x86/kernel/setup.c<br/>
3 1 kvm_para_has_feature 181 arch/x86/kernel/kvmclock.c<br/>
4 4 kvm_arch_para_features 32 include/linux/kvm_para.h<br/>
5 1 cpuid_eax 187 arch/x86/include/asm/kvm_para.h<br/>
6 21 cpuid 670 cpuid(op, &amp;eax, &amp;ebx, &amp;ecx, &amp;edx);<br/>
7 2 __cpuid 650 __cpuid(eax, ebx, ecx, edx);<br/>
8 1 native_cpuid 573 #define __cpuid native_cpuid </p>

<pre><code>172 static inline void native_cpuid(unsigned int *eax, unsigned int *ebx,
173                                 unsigned int *ecx, unsigned int *edx)
174 {
175         /* ecx is often an input as well as an output. */
176         asm volatile(&quot;cpuid&quot;
177             : &quot;=a&quot; (*eax),
178               &quot;=b&quot; (*ebx),
179               &quot;=c&quot; (*ecx),
180               &quot;=d&quot; (*edx)
181             : &quot;0&quot; (*eax), &quot;2&quot; (*ecx)
182             : &quot;memory&quot;);
183 }
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 29 setup_arch 500 init/main.c<br/>
2 1 kvmclock_init 1072 arch/x86/kernel/setup.c<br/>
3 1 kvm_register_clock 190 arch/x86/kernel/kvmclock.c<br/>
4 1 native_write_msr_safe 132 arch/x86/kernel/kvmclock.c </p>

<pre><code>98 /* Can be uninlined because referenced by paravirt */
99 notrace static inline int native_write_msr_safe(unsigned int msr,
100                                         unsigned low, unsigned high)
101 {       
102         int err; 
103         asm volatile(&quot;2: wrmsr ; xor %[err],%[err]\n&quot;
104                      &quot;1:\n\t&quot;
105                      &quot;.section .fixup,\&quot;ax\&quot;\n\t&quot;
106                      &quot;3:  mov %[fault],%[err] ; jmp 1b\n\t&quot;
107                      &quot;.previous\n\t&quot;
108                      _ASM_EXTABLE(2b, 3b)
109                      : [err] &quot;=a&quot; (err)
110                      : &quot;c&quot; (msr), &quot;0&quot; (low), &quot;d&quot; (high),
111                        [fault] &quot;i&quot; (-EIO)
112                      : &quot;memory&quot;);
113         return err;
114 }
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 29 setup_arch 500 init/main.c<br/>
2 1 tboot_probe 1091 arch/x86/kernel/setup.c<br/>
3 6 set_fixmap 83 arch/x86/kernel/tboot.c<br/>
4 5 __set_fixmap 179 arch/x86/include/asm/fixmap.h<br/>
5 1 native_set_fixmap 174 arch/x86/include/asm/fixmap.h<br/>
6 1 __native_set_fixmap 446 arch/x86/mm/pgtable.c<br/>
7 1 set_pte_vaddr 439 arch/x86/mm/pgtable.c<br/>
8 1 set_pte_vaddr_pud 229 arch/x86/mm/init_64.c<br/>
9 5 __flush_tlb_one 212 arch/x86/mm/init_64.c<br/>
10 2 __flush_tlb_single 60 __flush_tlb_single(addr);<br/>
11 1 __native_flush_tlb_single 15 #define __flush_tlb_single(addr) __native_flush_tlb_single(addr) </p>

<pre><code> 44 static inline void __native_flush_tlb_single(unsigned long addr)
 45 {       
 46         asm volatile(&quot;invlpg (%0)&quot; ::&quot;r&quot; (addr) : &quot;memory&quot;);
 47 }       
 48                 
</code></pre>

<h3 id="setup_per_cpu_areas">setup_per_cpu_areas</h3>

<p># TO tag FROM line in file/text<br/>
1 6 setup_per_cpu_areas 505 init/main.c<br/>
2 1 switch_to_new_gdt 267 arch/x86/kernel/setup_percpu.c<br/>
 3 1 load_gdt 377 arch/x86/kernel/cpu/common.c<br/>
4 1 native_load_gdt 89 #define load_gdt(dtr)^I<sup>I</sup>I<sup>Inative</sup>_load_gdt(dtr) </p>

<pre><code>213 static inline void native_load_gdt(const struct desc_ptr *dtr)
214 {
215         asm volatile(&quot;lgdt %0&quot;::&quot;m&quot; (*dtr));
216 }
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 6 setup_per_cpu_areas 505 init/main.c<br/>
2 1 switch_to_new_gdt 267 arch/x86/kernel/setup_percpu.c<br/>
3 1 load_percpu_segment 380 arch/x86/kernel/cpu/common.c<br/>
4 1 wrmsrl 362 arch/x86/kernel/cpu/common.c<br/>
5 1 native_write_msr 164 native_write_msr((msr), (u32)((u64)(val)), (u32)((u64)(val) &gt;&gt; 32)) </p>

<pre><code>92 static inline void native_write_msr(unsigned int msr,
93                                     unsigned low, unsigned high)
94 {
95         asm volatile(&quot;wrmsr&quot; : : &quot;c&quot; (msr), &quot;a&quot;(low), &quot;d&quot; (high) : &quot;memory&quot;);
96 }
97 
</code></pre>

<h3 id="trap_init">trap_init</h3>

<p># TO tag FROM line in file/text<br/>
1 30 trap_init 527 init/main.c<br/>
2 9 cpu_init 741 arch/x86/kernel/traps.c<br/>
3 1 load_idt 1183 arch/x86/kernel/cpu/common.c<br/>
4 1 native_load_idt 90 #define load_idt(dtr) native_load_idt(dtr)<br/>
5 1 lidt 220 asm volatile(&#8220;lidt %0&#8221;::&#8220;m&#8221; (*dtr)); </p>

<pre><code>218 static inline void native_load_idt(const struct desc_ptr *dtr)
219 {
220         asm volatile(&quot;lidt %0&quot;::&quot;m&quot; (*dtr));
221 }
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 30 trap_init 527 init/main.c<br/>
2 9 cpu_init 741 arch/x86/kernel/traps.c<br/>
3 1 load_TR_desc 1225 arch/x86/kernel/cpu/common.c<br/>
4 1 native_load_tr_desc 88 #define load_TR_desc()^I<sup>I</sup>I<sup>Inative</sup>_load_tr_desc() </p>

<pre><code>208 static inline void native_load_tr_desc(void)
209 {
210         asm volatile(&quot;ltr %w0&quot;::&quot;q&quot; (GDT_ENTRY_TSS*8));
211 }
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 30 trap_init 527 init/main.c<br/>
2 9 cpu_init 741 arch/x86/kernel/traps.c<br/>
3 1 load_LDT 1226 arch/x86/kernel/cpu/common.c<br/>
4 1 load_LDT_nolock 283 load_LDT_nolock(pc);<br/>
5 1 set_ldt 277 set_ldt(pc-&gt;ldt, pc-&gt;size);<br/>
6 1 native_set_ldt 99 #define set_ldt native_set_ldt </p>

<pre><code>192 static inline void native_set_ldt(const void *addr, unsigned int entries)
193 {
194         if (likely(entries == 0))
195                 asm volatile(&quot;lldt %w0&quot;::&quot;q&quot; (0));
196         else {
197                 unsigned cpu = smp_processor_id();
198                 ldt_desc ldt;
199 
200                 set_tssldt_descriptor(&amp;ldt, (unsigned long)addr, DESC_LDT,
201                                       entries * LDT_ENTRY_SIZE - 1);
202                 write_gdt_entry(get_cpu_gdt_table(cpu), GDT_ENTRY_LDT,
203                                 &amp;ldt, DESC_LDT);
204                 asm volatile(&quot;lldt %w0&quot;::&quot;q&quot; (GDT_ENTRY_LDT*8));
205         }
206 }
207 
</code></pre>

<p># TO tag FROM line in file/text<br/>
1 30 trap_init 527 init/main.c<br/>
2 9 cpu_init 741 arch/x86/kernel/traps.c<br/>
3 3 fpu_init 1231 arch/x86/kernel/cpu/common.c<br/>
4 3 write_cr0 108 arch/x86/kernel/i387.c<br/>
5 1 native_write_cr0 310 native_write_cr0(x); </p>

<pre><code>223 static inline void native_write_cr0(unsigned long val)
224 {
225         asm volatile(&quot;mov %0,%%cr0&quot;: : &quot;r&quot; (val), &quot;m&quot; (__force_order));
226 }
</code></pre>
